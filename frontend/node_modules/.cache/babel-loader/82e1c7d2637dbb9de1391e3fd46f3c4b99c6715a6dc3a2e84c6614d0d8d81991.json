{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { reactive, nextTick, toRaw, ref } from \"vue\";\nimport { required, email } from \"@vuelidate/validators\";\nimport { useVuelidate } from \"@vuelidate/core\";\nimport axios from \"axios\";\nimport { useRouter } from \"vue-router\";\nexport default {\n  setup() {\n    const form = reactive({\n      username: \"\",\n      email: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      terms: false,\n      location: \"\"\n    });\n    const showPassword = ref(false);\n    const passwordMatch = () => {\n      return form.password === form.confirmPassword;\n    };\n    const notAdmin = value => value !== \"admin\";\n    const rules = {\n      username: {\n        required,\n        notAdmin\n      },\n      email: {\n        required,\n        email\n      },\n      password: {\n        required\n      },\n      confirmPassword: {\n        required,\n        sameAs: passwordMatch\n      },\n      terms: {\n        required\n      },\n      location: {\n        required\n      }\n    };\n    const v$ = useVuelidate(rules, form);\n    const submittedData = ref(null);\n    const errorMessage = ref(null);\n    const router = useRouter();\n    function goToLogin() {\n      if (submittedData.value) {\n        router.push({\n          path: \"/login\",\n          query: {\n            username: submittedData.value.username\n          }\n        });\n      } else {\n        router.push(\"/login\");\n      }\n    }\n    async function submitForm() {\n      console.log(\"submitForm is called\");\n      console.log(\"v$ before $touch:\", v$);\n      await nextTick();\n      v$.value.$touch();\n      console.log(\"v$ after $touch:\", v$);\n      if (v$.value.$error) {\n        console.log(\"Form is invalid\");\n        console.log(\"Validation state:\", v$.value);\n        console.log(\"username error:\", v$.value.username.$error);\n        console.log(\"email error:\", v$.value.email.$error);\n        console.log(\"password error:\", v$.value.password.$error);\n        console.log(\"confirmPassword error:\", v$.value.confirmPassword.$error);\n        console.log(\"terms error:\", v$.value.terms.$error);\n        console.log(\"location error:\", v$.value.location.$error);\n        return;\n      }\n      console.log(\"Form is valid\", form);\n      let formData = toRaw(form);\n      delete formData.confirmPassword;\n      try {\n        const response = await axios.post(\"http://localhost:8000/api/register/\", formData);\n        if (response.data.success) {\n          submittedData.value = toRaw(form);\n          console.log(\"Rejestracja udana\");\n          errorMessage.value = null;\n        } else {\n          console.error(\"Błąd rejestracji:\", response.data.message);\n          errorMessage.value = response.data.message;\n        }\n      } catch (error) {\n        console.error(\"Błąd wysyłania danych:\", error);\n        if (error.response && error.response.data) {\n          errorMessage.value = error.response.data.message;\n        } else {\n          errorMessage.value = \"Registration failed, try again later\";\n        }\n      }\n    }\n    return {\n      form,\n      v$,\n      submitForm,\n      submittedData,\n      errorMessage,\n      goToLogin,\n      showPassword\n    };\n  }\n};","map":{"version":3,"names":["reactive","nextTick","toRaw","ref","required","email","useVuelidate","axios","useRouter","setup","form","username","password","confirmPassword","terms","location","showPassword","passwordMatch","notAdmin","value","rules","sameAs","v$","submittedData","errorMessage","router","goToLogin","push","path","query","submitForm","console","log","$touch","$error","formData","response","post","data","success","error","message"],"sources":["C:\\Users\\Djeja\\Desktop\\DjangoVue-Game\\frontend\\src\\views\\RegisterForm.vue"],"sourcesContent":["<template>\r\n\t<div class=\"container\">\r\n\t\t<h1 class=\"scoreboard-title text-center my-4\">Register</h1>\r\n\t\t<p v-if=\"errorMessage\" class=\"error\">{{ errorMessage }}</p>\r\n\t\t<div class=\"form-container transparent-bg\">\r\n\t\t\t<form @submit.prevent=\"submitForm\">\r\n\t\t\t\t<div v-if=\"submittedData\" class=\"card-header\" style=\"color: yellow !important\">&#128274; Form now in readonyl mode &#128274;</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<label for=\"username\">Username:</label>\r\n\t\t\t\t\t<input id=\"username\" v-model=\"form.username\" type=\"text\" :readonly=\"submittedData\" required />\r\n\t\t\t\t\t<p v-if=\"v$.username.$error\" class=\"error\">Username is invalid</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<label for=\"email\">Email:</label>\r\n\t\t\t\t\t<input id=\"email\" v-model=\"form.email\" type=\"email\" :readonly=\"submittedData\" required />\r\n\t\t\t\t\t<p v-if=\"v$.email.$error\" class=\"error\">Email is invalid</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<label for=\"password\">Password:</label>\r\n\t\t\t\t\t<input id=\"password\" v-model=\"form.password\" type=\"password\" :readonly=\"submittedData\" required />\r\n\t\t\t\t\t<p v-if=\"v$.password.$error\" class=\"error\">Password is invalid</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<label for=\"confirmPassword\">Confirm Password:</label>\r\n\t\t\t\t\t<input id=\"confirmPassword\" v-model=\"form.confirmPassword\" type=\"password\" :readonly=\"submittedData\" required />\r\n\t\t\t\t\t<p v-if=\"v$.confirmPassword.$error\" class=\"error\">Must be the same as password</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"checkbox-container\">\r\n\t\t\t\t\t<label for=\"terms\">Accept Terms and Conditions:</label>\r\n\t\t\t\t\t<input id=\"terms\" v-model=\"form.terms\" type=\"checkbox\" :disabled=\"submittedData\" required />\r\n\t\t\t\t\t<p v-if=\"v$.terms.$error\" class=\"error\">You must accept the terms and conditions</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<label for=\"location\">Location:</label>\r\n\t\t\t\t\t<select id=\"location\" v-model=\"form.location\" :disabled=\"submittedData\" required>\r\n\t\t\t\t\t\t<option value=\"\">Where are you from</option>\r\n\t\t\t\t\t\t<option value=\"eu\">Europe</option>\r\n\t\t\t\t\t\t<option value=\"na\">North-America</option>\r\n\t\t\t\t\t\t<option value=\"sa\">South-America</option>\r\n\t\t\t\t\t\t<option value=\"as\">Asia</option>\r\n\t\t\t\t\t\t<option value=\"af\">Africa</option>\r\n\t\t\t\t\t\t<option value=\"au\">Australia</option>\r\n\t\t\t\t\t\t<option value=\"other\">Other</option>\r\n\t\t\t\t\t</select>\r\n\t\t\t\t</div>\r\n\t\t\t\t<button type=\"submit\" :disabled=\"submittedData\">Register</button>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t\t<div v-if=\"!submittedData\" class=\"box-element col-12 col-sm-10 col-md-8 col-lg-7 mx-auto transparent-bg\">\r\n\t\t\t<div class=\"login-button\">\r\n\t\t\t\t<span>Already have account?</span>\r\n\t\t\t\t<button class=\"btn\" @click=\"goToLogin\" style=\"background-color: orange; margin-left: 10px\">Login</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div v-if=\"submittedData\" class=\"box-element col-12 col-sm-10 col-md-8 col-lg-7 mx-auto transparent-bg\">\r\n\t\t\t<div class=\"card-header\" style=\"color: green !important\">Successfully registered</div>\r\n\t\t\t<div class=\"card-header\">Your data:</div>\r\n\t\t\t<ul class=\"list-group list-group-flush\">\r\n\t\t\t\t<li class=\"list-group-item transparent-bg\" v-for=\"(value, key) in submittedData\" :key=\"key\">\r\n\t\t\t\t\t<strong>{{ key }}:</strong>\r\n\t\t\t\t\t<span v-if=\"key !== 'password'\">{{ value }}</span>\r\n\t\t\t\t\t<span v-else>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tstyle=\"width: 10ch; color: gold !important; background-color: transparent !important; border: none !important; outline: none !important\"\r\n\t\t\t\t\t\t\t:type=\"showPassword ? 'text' : 'password'\"\r\n\t\t\t\t\t\t\t:value=\"value\"\r\n\t\t\t\t\t\t\treadonly\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<button class=\"flames\" @click=\"showPassword = !showPassword\">{{ showPassword ? \"hide\" : \"show\" }}</button>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t\t<div class=\"login-button\">\r\n\t\t\t\t<span class=\"flames\">Now you can login:</span>\r\n\t\t\t\t<button class=\"btn\" @click=\"goToLogin\" style=\"background-color: orange\">Login</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n<script>\r\nimport { reactive, nextTick, toRaw, ref } from \"vue\";\r\nimport { required, email } from \"@vuelidate/validators\";\r\nimport { useVuelidate } from \"@vuelidate/core\";\r\nimport axios from \"axios\";\r\nimport { useRouter } from \"vue-router\";\r\n\r\nexport default {\r\n\tsetup() {\r\n\t\tconst form = reactive({\r\n\t\t\tusername: \"\",\r\n\t\t\temail: \"\",\r\n\t\t\tpassword: \"\",\r\n\t\t\tconfirmPassword: \"\",\r\n\t\t\tterms: false,\r\n\t\t\tlocation: \"\",\r\n\t\t});\r\n\t\tconst showPassword = ref(false);\r\n\t\tconst passwordMatch = () => {\r\n\t\t\treturn form.password === form.confirmPassword;\r\n\t\t};\r\n\t\tconst notAdmin = (value) => value !== \"admin\";\r\n\r\n\t\tconst rules = {\r\n\t\t\tusername: { required, notAdmin },\r\n\t\t\temail: { required, email },\r\n\t\t\tpassword: { required },\r\n\t\t\tconfirmPassword: { required, sameAs: passwordMatch },\r\n\t\t\tterms: { required },\r\n\t\t\tlocation: { required },\r\n\t\t};\r\n\r\n\t\tconst v$ = useVuelidate(rules, form);\r\n\r\n\t\tconst submittedData = ref(null);\r\n\t\tconst errorMessage = ref(null);\r\n\t\tconst router = useRouter();\r\n\t\tfunction goToLogin() {\r\n\t\t\tif (submittedData.value) {\r\n\t\t\t\trouter.push({\r\n\t\t\t\t\tpath: \"/login\",\r\n\t\t\t\t\tquery: {\r\n\t\t\t\t\t\tusername: submittedData.value.username,\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\trouter.push(\"/login\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tasync function submitForm() {\r\n\t\t\tconsole.log(\"submitForm is called\");\r\n\t\t\tconsole.log(\"v$ before $touch:\", v$);\r\n\t\t\tawait nextTick();\r\n\t\t\tv$.value.$touch();\r\n\t\t\tconsole.log(\"v$ after $touch:\", v$);\r\n\t\t\tif (v$.value.$error) {\r\n\t\t\t\tconsole.log(\"Form is invalid\");\r\n\t\t\t\tconsole.log(\"Validation state:\", v$.value);\r\n\t\t\t\tconsole.log(\"username error:\", v$.value.username.$error);\r\n\t\t\t\tconsole.log(\"email error:\", v$.value.email.$error);\r\n\t\t\t\tconsole.log(\"password error:\", v$.value.password.$error);\r\n\t\t\t\tconsole.log(\"confirmPassword error:\", v$.value.confirmPassword.$error);\r\n\t\t\t\tconsole.log(\"terms error:\", v$.value.terms.$error);\r\n\t\t\t\tconsole.log(\"location error:\", v$.value.location.$error);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log(\"Form is valid\", form)\r\n\t\t\tlet formData = toRaw(form);\r\n\t\t\tdelete formData.confirmPassword;\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst response = await axios.post(\"http://localhost:8000/api/register/\", formData);\r\n\r\n\t\t\t\tif (response.data.success) {\r\n\t\t\t\t\tsubmittedData.value = toRaw(form);\r\n\t\t\t\t\tconsole.log(\"Rejestracja udana\");\r\n\t\t\t\t\terrorMessage.value = null;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.error(\"Błąd rejestracji:\", response.data.message);\r\n\t\t\t\t\terrorMessage.value = response.data.message;\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error(\"Błąd wysyłania danych:\", error);\r\n\t\t\t\tif (error.response && error.response.data) {\r\n\t\t\t\t\t\r\n\t\t\t\t\terrorMessage.value = error.response.data.message;\r\n\t\t\t\t} else {\r\n\t\t\t\t\terrorMessage.value = \"Registration failed, try again later\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn { form, v$, submitForm, submittedData, errorMessage, goToLogin, showPassword };\r\n\t},\r\n};\r\n</script>\r\n<style scoped>\r\n.container {\r\n\tbox-sizing: border-box;\r\n\tmax-width: 100%;\r\n\toverflow-x: hidden;\r\n}\r\n.transparent-bg {\r\n\tbackground-color: transparent !important;\r\n\tcolor: white !important;\r\n\tborder: none !important;\r\n}\r\n.form-container {\r\n\twidth: 100%;\r\n\tmax-width: 600px;\r\n\tmargin: 0 auto;\r\n\tpadding: 20px;\r\n\tbackground-color: #f8f9fa;\r\n\tborder: 1px solid #dee2e6;\r\n\tborder-radius: 5px;\r\n}\r\n\r\nform div {\r\n\tmargin-bottom: 10px;\r\n}\r\n\r\nform label {\r\n\tdisplay: block;\r\n\tmargin-bottom: 5px;\r\n}\r\n\r\nform input,\r\nform select {\r\n\twidth: 100%;\r\n\tpadding: 5px;\r\n\tborder: 1px solid #ced4da;\r\n\tborder-radius: 3px;\r\n\tbackground-color: transparent !important;\r\n\tcolor: white !important;\r\n}\r\n\r\nform button {\r\n\tmargin-top: 20px;\r\n\tpadding: 10px 20px;\r\n\tbackground-color: #007bff;\r\n\tcolor: #fff;\r\n\tborder: none;\r\n\tborder-radius: 3px;\r\n\tcursor: pointer;\r\n}\r\nform select option {\r\n\tcolor: rgb(0, 0, 0);\r\n}\r\n\r\nform button:hover {\r\n\tbackground-color: #0056b3;\r\n}\r\n.checkbox-container {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: flex-start;\r\n\twhite-space: nowrap;\r\n}\r\n\r\n.checkbox-container input[type=\"checkbox\"] {\r\n\ttransform: scale(1.5);\r\n}\r\n@media (max-width: 700px) {\r\n\t.checkbox-container {\r\n\t\tflex-direction: column;\r\n\t}\r\n\r\n\t.checkbox-container input[type=\"checkbox\"] {\r\n\t\tmargin-right: 0;\r\n\t\tmargin-bottom: 10px;\r\n\t}\r\n}\r\n@keyframes flames {\r\n\t0% {\r\n\t\tcolor: #ff0000;\r\n\t}\r\n\t50% {\r\n\t\tcolor: #ff8000;\r\n\t}\r\n\t100% {\r\n\t\tcolor: #ff0000;\r\n\t}\r\n}\r\n\r\n.flames {\r\n\tanimation: flames 1s infinite;\r\n}\r\n.login-button {\r\n\tmargin-top: 20px;\r\n\tmargin-bottom: 20px;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}