{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { reactive, toRaw, onMounted, ref } from \"vue\";\nimport axios from \"axios\";\nimport { useRouter, useRoute } from \"vue-router\";\nexport default {\n  setup() {\n    const loginForm = reactive({\n      username: \"\",\n      password: \"\"\n    });\n    const errorMessage = ref(null);\n    const route = useRoute();\n    const router = useRouter();\n    function goToRegister() {\n      router.push(\"/register\");\n    }\n    //jesli przechodzimy z udanego rejestrowania to przekazuje nam username do forma\n    onMounted(() => {\n      if (route.query.username) {\n        loginForm.username = route.query.username;\n      }\n    });\n    async function submitLogin() {\n      const formData = toRaw(loginForm);\n      try {\n        const response = await axios.post(\"http://localhost:8000/api/login/\", formData);\n        if (response.data.success) {\n          console.log(\"Logowanie udane\");\n          // Zapisz dane użytkownika w localStorage\n          const accessToken = response.data.access_token;\n          const refreshToken = response.data.refresh_token;\n          localStorage.setItem(\"user\", JSON.stringify(response.data));\n          localStorage.setItem(\"accessToken\", accessToken);\n          localStorage.setItem(\"refreshToken\", refreshToken);\n          router.push(\"/\");\n        } else {\n          console.error(\"Błąd logowania:\", response.data.message, response.data.errors);\n          errorMessage.value = response.data.message;\n        }\n      } catch (error) {\n        console.error(\"Błąd wysyłania danych:\", error);\n        if (error.response) {\n          // Serwer zwrócił błąd, odczytaj komunikat o błędzie z odpowiedzi\n          errorMessage.value = error.response.data.message;\n        } else {\n          // Inny błąd, np. problem z siecią\n          errorMessage.value = \"Failed to send data to server\";\n        }\n      }\n    }\n    return {\n      loginForm,\n      submitLogin,\n      errorMessage,\n      goToRegister\n    };\n  }\n};","map":{"version":3,"names":["reactive","toRaw","onMounted","ref","axios","useRouter","useRoute","setup","loginForm","username","password","errorMessage","route","router","goToRegister","push","query","submitLogin","formData","response","post","data","success","console","log","accessToken","access_token","refreshToken","refresh_token","localStorage","setItem","JSON","stringify","error","message","errors","value"],"sources":["C:\\Users\\Djeja\\Desktop\\DjangoVue-Game\\frontend\\src\\views\\LoginForm.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"container\">\r\n\t\t\t<h1 class=\"scoreboard-title text-center my-4\">Login</h1>\r\n\t\t\t<p v-if=\"errorMessage\" class=\"error\">{{ errorMessage }}</p>\r\n\t\t\t<div class=\"form-container transparent-bg\">\r\n\t\t\t\t<form @submit.prevent=\"submitLogin\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<label for=\"loginUsername\">Username:</label>\r\n\t\t\t\t\t\t<input id=\"loginUsername\" v-model=\"loginForm.username\" type=\"text\" required />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<label for=\"loginPassword\">Password:</label>\r\n\t\t\t\t\t\t<input id=\"loginPassword\" v-model=\"loginForm.password\" type=\"password\" required />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<button type=\"submit\">Login</button>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"login-button\">\r\n\t\t\t\t<span>Don't have an account?</span>\r\n\t\t\t\t<button class=\"btn\" @click=\"goToRegister\" style=\"margin-left: 10px; background-color: orange\">Register</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { reactive, toRaw, onMounted, ref } from \"vue\";\r\nimport axios from \"axios\";\r\nimport { useRouter, useRoute } from \"vue-router\";\r\n\r\nexport default {\r\n\tsetup() {\r\n\t\tconst loginForm = reactive({\r\n\t\t\tusername: \"\",\r\n\t\t\tpassword: \"\",\r\n\t\t});\r\n\t\tconst errorMessage = ref(null);\r\n\t\tconst route = useRoute();\r\n\t\tconst router = useRouter();\r\n\r\n\t\tfunction goToRegister() {\r\n\t\t\trouter.push(\"/register\");\r\n\t\t}\r\n\t\t//jesli przechodzimy z udanego rejestrowania to przekazuje nam username do forma\r\n\t\tonMounted(() => {\r\n\t\t\tif (route.query.username) {\r\n\t\t\t\tloginForm.username = route.query.username;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tasync function submitLogin() {\r\n\t\t\tconst formData = toRaw(loginForm);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst response = await axios.post(\"http://localhost:8000/api/login/\", formData);\r\n\r\n\t\t\t\tif (response.data.success) {\r\n\t\t\t\t\tconsole.log(\"Logowanie udane\");\r\n\t\t\t\t\t// Zapisz dane użytkownika w localStorage\r\n\t\t\t\t\tconst accessToken = response.data.access_token;\r\n\t\t\t\t\tconst refreshToken = response.data.refresh_token;\r\n\t\t\t\t\tlocalStorage.setItem(\"user\", JSON.stringify(response.data));\r\n\t\t\t\t\tlocalStorage.setItem(\"accessToken\", accessToken);\r\n\t\t\t\t\tlocalStorage.setItem(\"refreshToken\", refreshToken);\r\n\t\t\t\t\trouter.push(\"/\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.error(\"Błąd logowania:\", response.data.message, response.data.errors);\r\n\t\t\t\t\terrorMessage.value = response.data.message;\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error(\"Błąd wysyłania danych:\", error);\r\n\t\t\t\tif (error.response) {\r\n\t\t\t\t\t// Serwer zwrócił błąd, odczytaj komunikat o błędzie z odpowiedzi\r\n\t\t\t\t\terrorMessage.value = error.response.data.message;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Inny błąd, np. problem z siecią\r\n\t\t\t\t\terrorMessage.value = \"Failed to send data to server\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn { loginForm, submitLogin, errorMessage, goToRegister };\r\n\t},\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n\tbox-sizing: border-box;\r\n\tmax-width: 100%;\r\n\toverflow-x: hidden;\r\n}\r\n.transparent-bg {\r\n\tbackground-color: transparent !important;\r\n\tcolor: white !important;\r\n\tborder: none !important;\r\n}\r\n.form-container {\r\n\twidth: 100%;\r\n\tmax-width: 600px;\r\n\tmargin: 0 auto;\r\n\tpadding: 20px;\r\n\tbackground-color: #f8f9fa;\r\n\tborder: 1px solid #dee2e6;\r\n\tborder-radius: 5px;\r\n}\r\n\r\nform div {\r\n\tmargin-bottom: 10px;\r\n}\r\n\r\nform label {\r\n\tdisplay: block;\r\n\tmargin-bottom: 5px;\r\n}\r\n\r\nform input {\r\n\twidth: 100%;\r\n\tpadding: 5px;\r\n\tborder: 1px solid #ced4da;\r\n\tborder-radius: 3px;\r\n\tbackground-color: transparent !important;\r\n\tcolor: white !important;\r\n}\r\n\r\nform button {\r\n\tmargin-top: 20px;\r\n\tpadding: 10px 20px;\r\n\tbackground-color: #007bff;\r\n\tcolor: #fff;\r\n\tborder: none;\r\n\tborder-radius: 3px;\r\n\tcursor: pointer;\r\n}\r\nform button:hover {\r\n\tbackground-color: #0056b3;\r\n}\r\n.login-button {\r\n\tmargin-top: 20px;\r\n\tmargin-bottom: 20px;\r\n}\r\n</style>\r\n"],"mappings":";AA2BA,SAASA,QAAQ,EAAEC,KAAK,EAAEC,SAAS,EAAEC,GAAE,QAAS,KAAK;AACrD,OAAOC,KAAI,MAAO,OAAO;AACzB,SAASC,SAAS,EAAEC,QAAO,QAAS,YAAY;AAEhD,eAAe;EACdC,KAAKA,CAAA,EAAG;IACP,MAAMC,SAAQ,GAAIR,QAAQ,CAAC;MAC1BS,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE;IACX,CAAC,CAAC;IACF,MAAMC,YAAW,GAAIR,GAAG,CAAC,IAAI,CAAC;IAC9B,MAAMS,KAAI,GAAIN,QAAQ,CAAC,CAAC;IACxB,MAAMO,MAAK,GAAIR,SAAS,CAAC,CAAC;IAE1B,SAASS,YAAYA,CAAA,EAAG;MACvBD,MAAM,CAACE,IAAI,CAAC,WAAW,CAAC;IACzB;IACA;IACAb,SAAS,CAAC,MAAM;MACf,IAAIU,KAAK,CAACI,KAAK,CAACP,QAAQ,EAAE;QACzBD,SAAS,CAACC,QAAO,GAAIG,KAAK,CAACI,KAAK,CAACP,QAAQ;MAC1C;IACD,CAAC,CAAC;IAEF,eAAeQ,WAAWA,CAAA,EAAG;MAC5B,MAAMC,QAAO,GAAIjB,KAAK,CAACO,SAAS,CAAC;MAEjC,IAAI;QACH,MAAMW,QAAO,GAAI,MAAMf,KAAK,CAACgB,IAAI,CAAC,kCAAkC,EAAEF,QAAQ,CAAC;QAE/E,IAAIC,QAAQ,CAACE,IAAI,CAACC,OAAO,EAAE;UAC1BC,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC;UAC9B;UACA,MAAMC,WAAU,GAAIN,QAAQ,CAACE,IAAI,CAACK,YAAY;UAC9C,MAAMC,YAAW,GAAIR,QAAQ,CAACE,IAAI,CAACO,aAAa;UAChDC,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACb,QAAQ,CAACE,IAAI,CAAC,CAAC;UAC3DQ,YAAY,CAACC,OAAO,CAAC,aAAa,EAAEL,WAAW,CAAC;UAChDI,YAAY,CAACC,OAAO,CAAC,cAAc,EAAEH,YAAY,CAAC;UAClDd,MAAM,CAACE,IAAI,CAAC,GAAG,CAAC;QACjB,OAAO;UACNQ,OAAO,CAACU,KAAK,CAAC,iBAAiB,EAAEd,QAAQ,CAACE,IAAI,CAACa,OAAO,EAAEf,QAAQ,CAACE,IAAI,CAACc,MAAM,CAAC;UAC7ExB,YAAY,CAACyB,KAAI,GAAIjB,QAAQ,CAACE,IAAI,CAACa,OAAO;QAC3C;MACD,EAAE,OAAOD,KAAK,EAAE;QACfV,OAAO,CAACU,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;QAC9C,IAAIA,KAAK,CAACd,QAAQ,EAAE;UACnB;UACAR,YAAY,CAACyB,KAAI,GAAIH,KAAK,CAACd,QAAQ,CAACE,IAAI,CAACa,OAAO;QACjD,OAAO;UACN;UACAvB,YAAY,CAACyB,KAAI,GAAI,+BAA+B;QACrD;MACD;IACD;IAEA,OAAO;MAAE5B,SAAS;MAAES,WAAW;MAAEN,YAAY;MAAEG;IAAa,CAAC;EAC9D;AACD,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}